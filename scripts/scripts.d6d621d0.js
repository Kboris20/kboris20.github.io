"use strict";angular.module("movieDemoApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","slick","ngFlag"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/film/:id",{templateUrl:"views/movie.html",controller:"MovieCtrl"}).when("/recherche/:query",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/favoris",{templateUrl:"views/favoris.html",controller:"FavorisCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("movieDemoApp").controller("MainCtrl",["$scope","moviesdb","$rootScope","$http","$routeParams",function(a,b,c,d,e){b.chargerFilms();var f=null,f=e.query;a.moviesdb=b,c.refresh=function(){b.chargerFilms(),a.moviesdb=b,c.titre=""},c.bgImage="";var g=a.moviesdb.getFilms();a.unfilm=g[0],null!=f&&(b.rechercherFilm(f),a.moviesdb=b),a.addFavori=function(a){b.addFavori(a)}}]),angular.module("movieDemoApp").controller("MovieCtrl",["$scope","$routeParams","moviesdb","$http","$rootScope",function(a,b,c,d,e){e.titre="",e.moviesdb=c;var f=b.id;d.get("http://amc.ig.he-arc.ch:3003/movie/"+f+"?append_to_response=similar,releases,credits&language=fr").success(function(b){a.film=b,e.bgImage=a.film.backdrop_path,a.pays=[];for(var c=a.film.releases.countries,d=0;d<c.length;d++)("DE"==c[d].iso_3166_1||"FR"==c[d].iso_3166_1||"US"==c[d].iso_3166_1)&&a.pays.push(c[d]);a.acteurs=[];for(var f=a.film.credits.cast,d=0;6>d;d++)a.acteurs.push(f[d]);a.realisateur;for(var g=a.film.credits.crew,d=0;d<g.length;d++)"Editor"==g[d].job&&(a.realisateur=g[d])})}]),angular.module("movieDemoApp").factory("moviesdb",["$http",function(a){function b(){localStorage.setItem("movies",JSON.stringify(d))}var c=[],d=[],e=localStorage.getItem("movies");if(e)var d=JSON.parse(e);else d=[];var f=42;return{someMethod:function(){return f},getFilms:function(){return c},rechercherFilm:function(b){a.get("http://amc.ig.he-arc.ch:3003/search/movie?query="+b+"&language=fr").success(function(a){c=a.results})},chargerFilms:function(){a.get("http://amc.ig.he-arc.ch:3003/movie/upcoming?language=fr").success(function(a){c=a.results})},addFavori:function(a){d.push(a),b()},getFavoris:function(){return d},deleteFavori:function(a){d.splice(d.indexOf(a),1),b()},isId:function(a){for(var b=0;b<d.length;b++)return d.indexOf(a)>-1?!0:!1}}}]),angular.module("movieDemoApp").filter("urlPoster",["moviesdb",function(a){return function(a){return a?"http://image.tmdb.org/t/p/w185"+a:"/images/noposter.jpg"}}]),angular.module("movieDemoApp").controller("FavorisCtrl",["$scope","moviesdb","$http","$rootScope",function(a,b,c,d){c.get("http://amc.ig.he-arc.ch:3003/movie/upcoming?language=fr").success(function(c){a.movies=c.results,a.favorisId=b.getFavoris(),a.favoris=[];for(var d=a.movies,e=0;e<d.length;e++)a.favorisId.indexOf(d[e].id)>-1&&a.favoris.push(d[e]);a.deleteFavori=function(c){b.deleteFavori(c.id),a.favoris.splice(a.favoris.indexOf(c),1)},a.isId=function(a){b.isId(a)}}),d.bgImage=""}]);